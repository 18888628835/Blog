# 判断类型
```javascript
const Type = {};
['String', 'Array', 'Number'].map((type) => {
  Type[`is${type}`] = (obj) => Object.prototype.toString.call(obj) === `[object ${type}]`
})

console.log(Type.isString('123'))
console.log(Type.isArray([1,2,3]))
console.log(Type.isNumber(123))
```
# 动态单例模式

```javascript
const myApp = {
  namespace(name) {
    var current = this
    var parts = name.split('.')
    for (let p of parts) {
      if (!current[p]) {
        current[p] = {}
      }
      current = current[p]
    }
  }
}
myApp.namespace('dom.style.classname')

//上面的代码相当于
var myApp={
  dom:{
    style:{
      classname:{}
    }
  }
}
```

# 创建唯一登录框(单例模式)

```javascript
// 通用单例模式函数
var singleton = function(handler) {
  let result
  return function() {
    return result || (result = handler.apply(this, arguments))
  }
}

var createLoginLayer = function() {
  div = document.createElement('div');
  div.innerHTML = '我是登录浮窗';
  div.style.display = 'none';
  document.body.appendChild(div);
  return div;
}
//组合生成单例模式
const createSingletonLoginLayer =singleton(createLoginLayer);

document.getElementById('loginBtn').onclick = function() {
  const LoginLayer = createSingletonLoginLayer()
  LoginLayer.style.display = 'block';
};

```



# 校验器(策略模式)

```javascript
// strategy策略对象
var strategies = {
  isNonEmpty: function (value, errorMsg) {
    // 不为空
    if (value === "") {
      return errorMsg;
    }
  },
  minLength: function (value, length, errorMsg) {
    // 限制最小长度
    if (value.length < length) {
      return errorMsg;
    }
  },
  isMobile: function (value, errorMsg) {
    // 手机号码格式
    if (!/(^1[3|5|8][0-9]{9}$)/.test(value)) {
      return errorMsg;
    }
  }
};

// Context类
class Validator {
  #cache = []; //保存校验规则
  add(dom, rule, errorMessage) {
    if (rule instanceof Array) {
      return this.addRules(dom, rule);
    }
    // 把校验的步骤用空函数包装起来，并且放入cache
    this.#cache.push(function () {
      const [strategyProperty, ...args] = rule.split(":"); //分割出需要传递给验证函数的参数
      //将验证逻辑委托给策略对象中的验证函数
      return strategies[strategyProperty].apply(dom, [
        dom.value,
        ...args,
        errorMessage
      ]);
    });
  }
  start() {
    for (let itemFunc of this.#cache) {
      let message = itemFunc();
      if (message) {
        return message;
      }
    }
  }
  addRules(dom, rules) {
    for (let [rule, errorMessage] of rules) {
      this.add(dom, rule, errorMessage);
    }
  }
}

var validator = new Validator(); 
validator.add(registerForm.phoneNumber, "isMobile", "手机号码格式不正确");
validator.add(registerForm.userName, [
    ["isNonEmpty", "用户名不能为空"],
    ["minLength:10", "用户名长度不能小于10位"]
  ]);
```