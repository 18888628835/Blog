## 一、H5是什么

互联网早期，我们上网冲浪主要通过电脑的浏览器、桌面软件等，随着手机技术的革新，目前手机已经超过电脑成为互联网的最大入口。

手机App则是手机中的内容载体，我们在手机上浏览各种内容离不开手机App软件的开发。

手机App可以分为三类：

* 原生应用（native application，简称native App）
* Web应用（web application，简称 Web App）
* 混合应用（hybrid application，简称hybrid App）

H5这个词，特指的是混合App的前端部分。它实际上就是HTML5网页。外国并没有H5这个词，直接叫混合App。

## 二、原生应用 

原生App是专门为特定的开发平台开发的应用程序，无法在其他平台运行。一个软件如果希望在苹果手机（ios平台）和安卓手机（android平台）同时运行，就需要开发两套App。

这是因为IOS是由苹果公司出的，安卓是谷歌公司出的，两家公司都发布了自家平台原生App的开发方式。

原生 App 使用与手机操作系统相同的语言。iOS 的原生 App 使用 Objective-C 语言或 Swift 语言，安卓使用 Java 语言或 Kotlin 语言。由于跟底层系统的语言和技术模型一致，所以原生 App 的性能和用户体验都很好。

原生App的优点体现在：

1. 性能和体验较好
2. 可以直接调用系统的软件和硬件的API，例如通知推送、摄像机、GPS等功能。

缺点则是：

1. 成本太高，一家公司同一个软件可能需要培养两个独立的团队，如果再出现第三者平台，例如鸿蒙，成本就会更高
2. 原生App使用的底层操作语言，是重型编译语言，开发周期长
3. 原生App比如下载安装才能使用



## 三、Web应用

Web应用是使用网页完成的应用程序，必须在浏览器中使用。

Web App主要使用Web技术，只需要兼容手机的样式、尺寸即可，用户直接通过浏览器输入URL就可以访问。

优点：

1. 开发快，成本低，只需要Web开发团队就可以完成
2. 不需要下载安装，打开浏览器就可以访问最新版本

缺点：

1. 浏览器提供的API有限，不具备完全使用手机操作系统的软硬件API的能力
2. 浏览器渲染的网页，不适合做性能要求高的页面。
3. 需要打开浏览器才能使用，不如原生App方便

### 3.1 PWA

从做浏览器的团队的立场来说，用户依赖浏览器是对他们最有利的行为。

谷歌公司的chrome团队就认为，Web App能够满足大多数人的需求，而且能给用户带来原生应用的体验。

为了推广Web App，他们开发了新技术“渐进式Web App”（Progressive Web App，缩写 PWA）。PWA 能做到原生应用的体验不是靠某一项特定技术，而是经过应用一系列新技术进行改进。

它能够解决以下问题：

1. 用户不需要通过浏览器，首屏就能直接进入Web App。
2. 缺乏通知推送能力。
3. 不支持断网使用

它主要是把网站缓存在手机里面，这样离线就可以使用，还可以在手机首屏生成图标，让用户直接点击进入，并且具有推送通知的能力。另外还隐藏了浏览器的地址栏和状态栏，跟原生的App体验非常接近。

但是，PWA需要浏览器访问一次网站，才能在首屏生成图标，并且目前IOS的支持并不理想，所以目前还是探索性的技术。

## 四、混合应用

 混合App就是把Web App跟原生App结合起来，它的壳是原生App，里面的内容放的是网页。

可以理解为，混合App内隐藏了一个浏览器，用户实际上是这个隐藏浏览器渲染出来的页面。

混合App从内到外有三层：容器层、网页引擎层、HTML5网页层。

混合App的外壳是容器层，内部隐藏的浏览器，通常是系统提供的网页渲染控件（WebView控件），也可以内置浏览器内核，网页层是用来展示页面的。

### 4.1 API Bridge

混合App里面的网页可以调用底层系统的所有API，奥秘就在外层容器提供了API Bridge，充当底层API的中介，允许内部的网页调用底层。

API Bridge是容器在底层接口和网页之间，建立的一层桥梁，让双方通信。容器一旦收到网页的请求，就根据请求去调用底层系统API，然后将结果返回给网页。

API Bridge 往往以 JavaScript 语言提供，方便网页调用，这时又称为 JSbridge。

API Bridge需要跟着平台更新，比如，IOS新发布了版本，有了新的硬件API，容器也必须跟着出新的API Bridge，否则网页就不能使用新的硬件。

### 4.2 混合应用的优缺点

混合App同时具有原生App和Web App的优点，如下：

1. 跨平台，开发者只需要写一次页面，就能够支持多个平台，开发成本低
2. 开发便捷，传统的前端程序员就可以完成功能
3. 版本更新容易，只需要在服务器发布更新版本，并触发容器内更新就可以了。



缺点也很明显：

1. 由于存在网页引擎的中间层，性能不仅不如原生App，而且由于WebView并非全功能浏览器，可能比Web App也要慢一些
2. 由于页面跨平台，就无法使用特定平台提供的功能，导致体验不如原生App。比如早期安卓有物理后退按钮，iPhone没有，所以IOS的页面设计就需要加上后退按钮，这样产生的结果是同样的页面在安卓上会出现两个后退按钮。



### 4.3 小程序

小程序可以看作是针对特定容器的H5开发。微信本身就是这样一个容器，它开放了自己的接口，外部开发者使用规定的语法，编写页面，容器可以动态加载这些页面。

小程序对于微信官方的好处是扩展了功能和应用场景，繁荣了微信生态。给外部开发者带来的好处是有了流量入口，并且还能调用微信的一些功能。



## 五、手机App技术栈

手机App的技术栈可以分成三类：

1. 原生App技术栈

   特定于手机平台的开发技术。比如安卓的Java技术栈，IOS平台的Swift或Object-C技术栈，这种技术栈只能用于一个平台。

2. 混合App技术栈

   开发混合App的技术，也就是把Web网页放到特定的容器中，然后打包成各个平台的原生App。混合技术栈其实是Web技术栈+容器技术栈。主要学习方向是通过容器提供的API Bridge，来使得网页可以调用底层硬件的API

3. 跨平台App技术栈

   跨平台技术栈指的是一种技术同时支持多个手机平台。它与混合技术栈的区别是，**不适用Web技术，它的页面并不是HTML5页面，而是使用自己的语法写的UI层，然后编译成各平台的原生App。**

   这个技术栈是纯粹的容器技术栈，除了要学习容器的API Bridge，还需要学习容器提供的书写UI页面的方法。

H5 开发主要用在混合技术栈。但是，跨平台技术栈的某些容器也会用到（比如 React Native），因为它们的 UI 层借鉴了 Web 模型。

### 5.1 WebView控件

不管用什么技术，最终想在App中显示页面，都需要网页引擎才能解析页面。

通常情况下，App内部会提供WebView控件作为网页引擎，这是系统提供的硬件专门用来显示网页。应用程序的界面，只要放上WebView，就好像装上了浏览器窗口，就可以显示网页。

但不同的App技术栈处理WebView控件的方式不同：

* 原生技术栈：需要开发者自己把WebView控件放页面上
* 混合技术栈：页面本身就是网页，默认在WebView上显示
* 跨平台技术栈：提供一个WebView语法，编译的时候将其换成原生的WebView

###  5.2 混合技术栈

混合技术栈的容器设置好了WebView，开发者直接用Web技术写页面就行了。

* **APICloud**

...

### 5.3 跨端技术栈

* **uni-app**：跟Taro类似，uni-app提供的WebView语法是web技术的vue.js框架语法，能够发布到IOS、Android、小程序等各平台上。由于WebView语法跟Web技术栈一致，所以上手难度低。缺点是想要支持全平台，一些兼容性的bug难以避免
* **Flutter**：由谷歌内部孵化的移动端跨平台UI框架，算是目前最接近原生体验的跨平台技术框架。跟uni-app继承自Vue.js不同，Flutter需要用谷歌新的Dart语言和新的UI语法来开发，所以上手难度稍微大一点
* **React Native**：RN主要想法是用React的Virtual DOM来渲染不同平台的UI，渲染过程交给了原生渲染引擎。虽然想法很好，但是由于安卓跟苹果平台依然有差异，这种差异无法使用Virtual DOM来抹平，会出现一些奇怪的小毛病
* **Hummer**：由滴滴出品的跨端开发框架，支持Vue/React/TS/JS语法。缺点是知道的人太少了，可能是个小而美的框架
* **Taro**：具有多端能力，一次编写，能编译成各种小程序、H5、React Native。目前支持React语法、Vue语法等。

...

在上述跨端技术栈中，除了Flutter，其他都可以使用Web技术的语法来简化开发。
